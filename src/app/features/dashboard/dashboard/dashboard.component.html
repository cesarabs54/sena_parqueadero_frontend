<div class="p-6">
  <div class="flex justify-between items-center mb-6">
    <h2 class="text-2xl font-bold text-white m-0">Estado del Parqueadero</h2>
    <p-button label="Actualizar" icon="pi pi-refresh" [loading]="loading()"
              (onClick)="loadOccupancy()"
              [rounded]="true"></p-button>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    <!-- Total Summary -->
    <div
      class="bg-slate-900 p-6 rounded-xl shadow-lg border border-slate-800 flex flex-col items-center">
      <h3 class="text-slate-400 font-medium mb-4">Ocupación Total</h3>
      <p-knob [ngModel]="totalOccupancy()" [readonly]="true" [max]="1000" valueTemplate="{value}"
              size="150"
              rangeColor="#1e293b" valueColor="#3b82f6"></p-knob> <!-- Helper blue for total -->
      <span class="text-white font-bold mt-2">Vehículos en Total</span>
    </div>

    <!-- Individual Zones -->
    <div *ngFor="let lot of parkingLots()"
         class="bg-slate-900 p-6 rounded-xl shadow-lg border border-slate-800 flex flex-col items-center">
      <h3 class="text-slate-200 font-bold mb-1">{{ lot.name }}</h3>
      <p class="text-slate-500 text-sm mb-4">{{ getFreeSpaces(lot.capacity, lot.occupied) }} lugares
        libres</p>

      <p-knob [ngModel]="lot.occupied" [readonly]="true" [max]="lot.capacity"
              valueTemplate="{value} / {{lot.capacity}}"
              size="150" rangeColor="#1e293b"
              [valueColor]="getAvailabilityColor(lot.capacity, lot.occupied)"></p-knob>

      <div class="mt-4 flex gap-2">
        <span class="px-3 py-1 rounded-full text-xs font-bold"
              [ngStyle]="{'background-color': getAvailabilityColor(lot.capacity, lot.occupied) + '20', 'color': getAvailabilityColor(lot.capacity, lot.occupied)}">
          {{ (getFreeSpaces(lot.capacity, lot.occupied) / lot.capacity * 100) | number:'1.0-0' }}% Libre
        </span>
      </div>
    </div>
  </div>
</div>
